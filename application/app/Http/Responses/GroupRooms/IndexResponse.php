<?php/** -------------------------------------------------------------------------------- * This classes renders the response for the [store] process for the team * controller * @package    Grow CRM * @author     NextLoop *----------------------------------------------------------------------------------*/namespace App\Http\Responses\GroupRooms;use Illuminate\Contracts\Support\Responsable;class IndexResponse implements Responsable {    private $payload;    public function __construct($payload = array()) {        $this->payload = $payload;    }    /**     * render the view for team members     *     * @param  \Illuminate\Http\Request  $request     * @return \Illuminate\Http\Response     */    public function toResponse($request) {        //set all data to arrays        foreach ($this->payload as $key => $value) {            $$key = $value;        }		$html = '';		$cnt = count($groups);		if((int)$cnt > 0){			foreach($groups as $group){				$html .= '<li class="list-group-item list-group-item-employee">'.$group->grouproom_name.'				<span class="list-table-action dropdown font-size-inherit ">					<button type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" title="Action" class="data-toggle-action-tooltip btn btn-outline-default-light btn-circle btn-sm">						<i class="sl-icon-options"></i>					</button>					<div class="dropdown-menu" aria-labelledby="listTableAction" style="">						<a class="dropdown-item" href="javascript:void(0)" onclick="showChat('.$group->grouproom_id.',\'' . $group->grouproom_name . '\');">View chat</a>												<a class="dropdown-item edit-add-modal-button js-ajax-ux-request reset-target-modal-form" href="javascript:void(0)" data-toggle="modal" data-target="#commonModal" data-modal-title="Edit group" data-url="'.url('grouprooms/edit/'.$group->grouproom_id).'"  data-action-url="'.url('grouprooms/update/'.$group->grouproom_id).'?source='.$str_source.'" data-loading-target="commonModalBody" data-action-method="POST">							Edit</a>						<a class="dropdown-item confirm-action-danger" href="javascript:void(0)" data-confirm-title="'.cleanLang(__('lang.delete_group')).'"										data-confirm-text="'.cleanLang(__('lang.delete_group')).'" data-ajax-type="DELETE"										data-url="'.url('grouprooms/'.$group->grouproom_id).'?source='.$str_source.'">										Delete</a>																<a class="dropdown-item edit-add-modal-button js-ajax-ux-request reset-target-modal-form" href="javascript:void(0)" data-toggle="modal" data-target="#commonModal" data-modal-title="Assign employee" data-url="'.url('grouprooms/assign/'.$group->grouproom_id).'"  data-action-url="'.url('grouprooms/process_assign/'.$group->grouproom_id).'" data-loading-target="commonModalBody" data-action-method="POST">										Assign employee</a>';																	$html .= '	</div>				</span>';				if(isset($list_employee[$group->grouproom_id])){					$html .= '<ul>';					foreach($list_employee[$group->grouproom_id] as $le){						$html .= '<li class="list-group-item list-employee">'.$le['first_name'].'						<span class="list-table-action list-table-action-employee dropdown font-size-inherit">										<button type="button" title="Unassign '.$le['first_name'].' from '.$group->grouproom_name.' "											class="data-toggle-action-tooltip btn btn-outline-default-light btn-circle btn-sm confirm-action-danger"											data-confirm-title="Unassign User '.$le['first_name'].' from '.$le['first_name'].'  "											data-confirm-text="'.cleanLang(__('lang.delete_group')).'" data-ajax-type="POST"											data-url="'.url('grouprooms/unassign/'.$le['groupassigned_id']).'">											<i class="sl-icon-user-unfollow"></i>										</button>									 </span>												</li>';					}					$html .= '</ul>';				}												$html .='</li>';			}			}else{			$html .='<div class="page-notification"><img src="'.url('/public/images/no-results-found.png').'" alt="404" />';			$html .='<div class="title">Ooops - No records were found</div> <div class="sub-title">"'.cleanLang(__('lang.try_a_differet_search')).'"</div></div>';		}        $jsondata['dom_html'][] = array(            'selector' => '#groups-li-container',            'action' => 'replace',            'value' => $html);        //close modal        $jsondata['dom_visibility'][] = array('selector' => '#commonModal', 'action' => 'close-modal');        //response        return response()->json($jsondata);    }}